{"version":3,"sources":["../src/index.js"],"names":["config","routesConfig","res","url","app","router","middleware","connect","methods","routes","use"],"mappings":";;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;;;AADoC;AACY;;AAKhD;;;;;AAKe,wBAAgBA,MAAhB,EAAwBC,YAAxB,EAAsC;AACnD,QAAMC,MAAM,MAAM,uBAASF,MAAT,CAAlB;AACA,QAAM;AAAEG,OAAF;AAAOC,OAAP;AAAYC,UAAZ;AAAoBC,cAApB;AAAgCC;AAAhC,MAA4CL,GAAlD;AAEA,MAAIM,OAAJ;;AAEA,MAAIP,YAAJ,EAAkB;AAChBO,cAAU,MAAM,yBAAYP,YAAZ,EAA0BK,UAA1B,EAAsCD,MAAtC,CAAhB;AACA,UAAMI,SAASJ,OAAOI,MAAP,EAAf;AACAL,QAAIM,GAAJ,CAAQD,MAAR;AACD;;AAED,SAAO;AAAEN,OAAF;AAAOC,OAAP;AAAYG,WAAZ;AAAqBC,WAArB;AAA8BH;AAA9B,GAAP;AACD;AAED;;;;;;;;;;;;;AAcA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA","sourcesContent":["import startApp from './lib/start-app'\nimport { initRoutes2 } from './lib/routes'\nimport Config from './types/Config' // eslint-disable-line\nimport RoutesConfig from './types/RoutesConfig' // eslint-disable-line\n\nexport { default as startApp } from './lib/start-app'\nexport { initRoutes } from './lib/routes'\n\n/**\n * Start the server.\n * @param {Config} config A configuration object.\n * @param {RoutesConfig} [routesConfig] A configuration object for the router.\n */\nexport default async function (config, routesConfig) {\n  const res = await startApp(config)\n  const { url, app, router, middleware, connect } = res\n\n  let methods\n\n  if (routesConfig) {\n    methods = await initRoutes2(routesConfig, middleware, router)\n    const routes = router.routes()\n    app.use(routes)\n  }\n\n  return { url, app, connect, methods, router }\n}\n\n/**\n * @typedef {Object.<string, (route: function) => (string|function)[]>} MiddlewareMap\n *\n * @typedef {Object.<string, string[]>} AliasMap\n *\n * @typedef {Object} RoutesConfig\n * @property {string} dir Path to the directory with routes.\n * @property {MiddlewareMap} middleware A middleware configuration for methods.\n * @property {function} [filter] Optional filter for filenames. Defaults to importing JS and JSX.\n * @property {boolean} [defaultImports=true] Whether the routes are exported with `export` keyword. Defaults to true.\n * @property {AliasMap} [aliases] a map of aliases\n */\n\n\n/**\n * @typedef {Object} Koa2JsxConfig\n * @property {function} View A Redux connected container\n * @property {function} [reducer] A root reducer to create the store\n * @property {Object} [actions] A map of action creators\n * @property {function} [render] An optional render function. Stream rendering\n * is used by default.\n\n * @typedef {Object} Koa2JSX\n * @property {boolean} use Use middleware on every page (calls app.use())\n * @property {Koa2JsxConfig} [config] Middleware configuration\n * @property {boolean} wireframe Whether to set up a wireframe website.\n * @property {boolean} bootstrap Whether to add Bootstrap 4.\n\n * @typedef ISignature\n * @property {boolean} use\n * @property {Object} config\n * @property {Object} [rest]\n\n * @typedef {Object} MiddlewareConfig\n * @property {ISignature} [session]\n * @property {ISignature} [multer]\n * @property {ISignature} [csrf]\n * @property {ISignature} [compress]\n * @property {ISignature} [bodyparser]\n * @property {ISignature} [checkauth]\n * @property {ISignature} [logger]\n * @property {Koa2JSX} [koa2Jsx]\n */\n\n/**\n * @typedef {Object} Config\n * @property {string} [databaseURL='mongodb://localhost:27017']\n * @property {number} [port=5000]\n * @property {number} [host=0.0.0.0]\n * @property {MiddlewareConfig} [middleware]\n * @property {boolean} [autoConnect=true] Whether to automatically connect to the database.\n */\n"],"file":"index.js"}